(function(a,b){jQuery.fn.bgScroll=function(c){c=a.extend({},jQuery.fn.bgScroll.defaults,c);var d=function(d){var e=this;d.css(c.containerCss),a("<img/>",{src:c.image,css:{position:"absolute"}}).appendTo(d).hide().load(function(){e.$image=a(this),e.orgWidth=a(this).width(),e.orgHeight=a(this).height(),e.imageRatio=e.orgWidth/e.orgHeight,e.currentStep=c.startStep,e.minDiffBottom=c.steps*c.stepMinHeight,e.update(),e.$image.fadeIn(),a(b).on("resize",a.proxy(e.update,e))}),d.on("bgscroll.next",a.proxy(this.next,this)),d.on("bgscroll.prev",a.proxy(this.prev,this))};return d.prototype.prev=function(){if(this.currentStep<=1)return;this.gotoStep(this.currentStep-1)},d.prototype.next=function(){if(this.currentStep>=c.steps)return;this.gotoStep(this.currentStep+1)},d.prototype.gotoStep=function(a){this.$image.animate({top:a*this.currentStepDistance+"px"},c.animationTime),this.currentStep=a},d.prototype.update=function(){var d=a(b).width(),e=a(b).height(),f=d/this.orgWidth,g=(e+this.minDiffBottom)/this.orgHeight,h=f>g?f:g,i=h*this.orgWidth,j=h*this.orgHeight,k=e-j,l=k/c.steps;if(i>d){var m=d-i,n=m/2;this.$image.css({left:n})}else this.$image.css({left:0});return this.$image.css({top:l*(this.currentStep-1)+"px"}),this.$image.width(i),this.$image.height(j),this.currentStepDistance=l,this},this.each(function(){new d(a(this))})},jQuery.fn.bgScroll.defaults={image:"background.jpg",steps:3,startStep:1,stepMinHeight:50,animationTime:800,containerCss:{width:"100%",height:"100%",top:"0",left:"0",position:"absolute",overflow:"hidden"}}})(jQuery,window);